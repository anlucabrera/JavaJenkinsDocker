<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                template="/WEB-INF/templates/template.xhtml"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:define name="head-end">
        <script>
            function descargar(ruta) {
                var win = window.open(ruta, '_blank');
                if (win) {
                    win.focus();
                }
            }
        </script>
        <style type="text/css">
            .ui-datatable .ui-datatable-header {
                text-align: right !important;
            }
            @media print{
                /* indicamos el salto de pagina */
                .saltoDePagina{
                    display:block;
                    page-break-inside:auto !important;
                    font-size: xx-small !important;
                }
            }
        </style>
        <!-- Inicio estilos par proceso electoral -->
        <c:if test="#{utilidadesAcceso.procesoElectoralActivo}">
            <link rel="stylesheet" type="text/css" href="../../resources/css/procesoElectoral.css" media="screen" />
        </c:if>
        <link rel="stylesheet" type="text/css" href="../../resources/css/estilosGeneralesPrint.css" media="screen" />
        <!-- Fin estilos par proceso electoral -->
    </ui:define>

    <ui:define name="title">
        Programa de Trabajo Anual
    </ui:define>

    <ui:define name="description">
        Reportes
    </ui:define>

    <ui:define name="body">
        <c:if test="#{consultarPOAReportePYE.cargado}">
            <h:form id="frmAlineacionEstratejica" prependId="false" class="form-inline">
                <div class="box box-primary">
                    <div id="main-buttons" class="hidden-sm hidden-xs" >
                        <p:panel header="Alineación estratégica">
                            <div class="row">
                                <div class="col-sm-10 col-md-3 col-lg-3">
                                    <p:autoUpdate/>
                                    <p:outputLabel value="Área:" />

                                    <p:selectOneMenu filter="true" filterMatchMode="contains" id="eje" value="#{consultarPOAReportePYE.areaPOASeleccionada.area}" valueChangeListener="#{consultarPOAReportePYE.areaSeleccionada}">
                                        <f:selectItems value="#{consultarPOAReportePYE.areasUniversidadsRegistros}" var="area" itemValue="#{area.area}" itemLabel="#{area.area} -- #{area.nombre}" />
                                        <p:ajax update=":frm" listener="#{consultarPOAReportePYE.imprimirValores()}"/>
                                    </p:selectOneMenu>
                                    <p:message for="eje" display="tooltip" />
                                </div>
                                <div class="col-sm-2 border-right">
                                    <p:outputLabel for="anio" value="Año" />
                                    <p:selectOneMenu  id="anio" value="#{consultarPOAReportePYE.ejercicioFiscal}" valueChangeListener="#{consultarPOAReportePYE.numeroAnioAsiganado}">
                                        <f:selectItems value="#{utilidadesAcceso.aniosReportes}" var="anio" itemValue="#{anio.ejercicioFiscal}" itemLabel="#{anio.anio}" />
                                        <p:ajax listener="#{consultarPOAReportePYE.imprimirValores()}" process="anio" update=":frm"/>
                                    </p:selectOneMenu >
                                </div>
                            </div>
                        </p:panel>
                    </div>
                </div>
            </h:form>
            <h:form id="frm" prependId="false" class="form-inline">
                <p:commandButton value="Imprimir POA" icon="fa fa-print" class="btn-success" actionListener="#{consultarPOAReportePYE.imprimirReporte()}"/>
                <p:panel id="CV" style="overflow: hidden !important">
                    <div class="row" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
                        <div class="col-md-12">
                            <div class="box box-widget widget-user-2">
                                <div class="row">
                                    <div class="col-sm-3 pull-left" style="width: 225px">
                                        <div class="description-block" style="text-align: center">
                                            <img src="../../resources/img/utxj.png" alt="" width="200px"/>
                                        </div>
                                    </div>
                                    <div class="col-sm-6 pull-left">
                                        <div class="row">

                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="description-block" style="text-align: center">
                                                        <h3><strong>Programa de Trabajo Anual 20#{consultarPOAReportePYE.ejercicioFiscal+1}</strong></h3>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="description-block" style="text-align: center">
                                                        <h4>Universidad Tecnológica de Xicotepec de Juárez</h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="description-block" style="text-align: center">
                                                        <h5><strong>#{consultarPOAReportePYE.areaPOASeleccionada.nombre}</strong></h5>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3 pull-right">
                                        <div class="description-block" style="text-align: center">
                                            <img src="../../resources/img/sii.png" alt="" width="80px"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="box box-primary">
                                        <div class="box-header with-border">
                                            <div class="box box-solid">
                                                <div class="box-body">
                                                    <div class="row">
                                                        <div class="col-lg-12 col-md-12 text-info text-center">
                                                            <p:remoteCommand name="actualizarTabla2" actionListener="#{consultarPOAReportePYE.imprimirValores()}" update=":frm:dtbBajas" />
                                                            <p:dataTable id="dtbBajas" widgetVar="dtbBajas" var="ejesRegistro" 
                                                                         sortBy="#{ejesRegistro.ejesRegistro.eje}" expandableRowGroups="false"
                                                                         value="#{consultarPOAReportePYE.ejesEsLaAp}">
                                                                <f:facet name="header"></f:facet>
                                                                <p:headerRow>
                                                                    <p:column colspan="1" styleClass="eje" style="text-align: left; color: #FFFFFF;">
                                                                        <h:outputText value="#{ejesRegistro.ejesRegistro.eje}.#{ejesRegistro.ejesRegistro.nombre}" style="color: white!important;margin-right: 12px;margin-left: 12px; font-size: 25px"/>
                                                                    </p:column>
                                                                </p:headerRow>
                                                                <p:column colspan="1" style="padding: 0px 0px">
                                                                    <p:dataTable value="#{ejesRegistro.estrategiaLineas}" var="estrategiasRegistro" sortBy="#{estrategiasRegistro.estrategias.estrategia}" expandableRowGroups="false">
                                                                        <p:headerRow>
                                                                            <p:column colspan="1" styleClass="est" style="text-align: left; color: #FFFFFF;">
                                                                                <h:outputText value="#{ejesRegistro.ejesRegistro.eje}.#{estrategiasRegistro.estrategias.numero} -- #{estrategiasRegistro.estrategias.nombre}" style="color: white!important;margin-right: 12px;margin-left: 12px; font-size: 20px"/>
                                                                            </p:column>
                                                                        </p:headerRow>
                                                                        <p:column  colspan="1" style="padding: 0px 0px">
                                                                            <p:dataTable value="#{estrategiasRegistro.actividadeRecurso}" var="poa" sortBy="#{poa.actividadesPoa.cuadroMandoInt.lineaAccion.lineaAccion}"                                                                  expandedRow="true"
                                                                                         expandableRowGroups="false" rowStyleClass="#{poa.actividadesPoa.numeroS eq 0?'actividad':''}" emptyMessage="No hay actividades registradas">

                                                                                <p:columnGroup type="header">
                                                                                    <p:row class="success">
                                                                                        <p:column rowspan="2" style="width:50px" styleClass="hederTablesTitle" rendered="false"/>
                                                                                        <p:column rowspan="2" headerText="No." style="width: 50px;" styleClass="hederTablesTitle"/>
                                                                                        <p:column rowspan="2" headerText="Actividad" styleClass="hederTablesTitle"/>
                                                                                        <p:column rowspan="2" headerText="Unidad de medida" style="width:100px;" styleClass="hederTablesTitle"/>
                                                                                        <p:column colspan="12" headerText="Calendarización de Metas" style="width: 700px;" styleClass="hederTablesTitle"/>  
                                                                                        <p:column rowspan="2" headerText="Total" style="width: 50px;" styleClass="hederTablesTitle"/>
                                                                                        <p:column rowspan="2" headerText="Justificacion" styleClass="hederTablesTitle"/>
                                                                                    </p:row>
                                                                                    <p:row class="success">
                                                                                        <p:column headerText="Ene" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Feb" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Mar" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Abr" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="May" styleClass="hederTablesTitle"/>                                                    
                                                                                        <p:column headerText="Jun" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Jul" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Ago" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Sep" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Oct" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Nov" styleClass="hederTablesTitle"/>
                                                                                        <p:column headerText="Dic" styleClass="hederTablesTitle"/>
                                                                                    </p:row>
                                                                                </p:columnGroup>            

                                                                                <p:headerRow>
                                                                                    <p:column colspan="17" styleClass="lac" style="text-align: left; color: #000000;">
                                                                                        <h:outputText value="#{poa.actividadesPoa.cuadroMandoInt.lineaAccion.nombre}"/>
                                                                                    </p:column>
                                                                                </p:headerRow>  

                                                                                <p:column rendered="false">
                                                                                    <p:rowToggler rendered="false" />
                                                                                </p:column>
                                                                                <p:column rendered="false"/>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.numeroP}.#{poa.actividadesPoa.numeroS}" />
                                                                                </p:column>
                                                                                <p:column style="text-align: justify">
                                                                                    <h:outputText value="#{poa.actividadesPoa.denominacion}"/>
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.medidas.nombre}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPEnero}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPFebrero}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPMarzo}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPAbril}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPMayo}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPJunio}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPJulio}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPAgosto}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPSeptiembre}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPOctubre}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPNoviembre}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.NPDiciembre}" />
                                                                                </p:column>
                                                                                <p:column>
                                                                                    <h:outputText value="#{poa.actividadesPoa.total}" />
                                                                                </p:column>
                                                                                <p:column style="text-align: justify" >
                                                                                    <h:outputText value="#{poa.actividadesPoa.descripcion}" />
                                                                                </p:column>
                                                                                <p:rowExpansion rendered="#{poa.recursosActividad.size() eq 0?false:true}">
                                                                                    <p:panelGrid id="pnlRecurso" style="text-align:justify;" columns="1">
                                                                                        <p:dataTable id="dtbBajas" var="recurso" style="background:  #cccccc"                                                                        
                                                                                                     sortBy="#{recurso.partidas.partida}" expandableRowGroups="false" value="#{poa.recursosActividad}">

                                                                                            <f:facet name="header"></f:facet>

                                                                                            <p:columnGroup type="header">
                                                                                                <p:row class="success">
                                                                                                    <p:column rowspan="2" headerText="Producto" style="width: 200px;" styleClass="hederTablesTitle"/>
                                                                                                    <p:column rowspan="2" headerText="Unidad de Medida" style="width: 80px;" styleClass="hederTablesTitle"/>
                                                                                                    <p:column rowspan="2" headerText="Capitulo Descuento" style="width: 80px;" styleClass="hederTablesTitle"/>
                                                                                                    <p:column colspan="12" headerText="Calendarización de Metas" style="width: 650px;" styleClass="hederTablesTitle"/>  
                                                                                                    <p:column rowspan="2" headerText="Total" style="width: 70px;" styleClass="hederTablesTitle"/>
                                                                                                </p:row>
                                                                                                <p:row class="success">
                                                                                                    <p:column headerText="Ene" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Feb" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Mar" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Abr" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="May" styleClass="hederSubTablesTitle"/>                                                    
                                                                                                    <p:column headerText="Jun" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Jul" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Ago" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Sep" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Oct" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Nov" styleClass="hederSubTablesTitle"/>
                                                                                                    <p:column headerText="Dic" styleClass="hederSubTablesTitle"/>
                                                                                                </p:row>
                                                                                            </p:columnGroup>

                                                                                            <p:headerRow>
                                                                                                <p:column colspan="1" style="background: #cccccc;">
                                                                                                    <h:outputText value="Partida: #{recurso.partidas.partida}" />
                                                                                                </p:column>
                                                                                                <p:column colspan="15"  style="background: #cccccc;">
                                                                                                    <h:outputText value="#{recurso.partidas.denominacion}" />
                                                                                                </p:column>
                                                                                            </p:headerRow>
                                                                                            <p:column>
                                                                                                <h:outputText value="#{recurso.productos.productosPK.producto} -- #{recurso.productos.descripcion}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center">
                                                                                                <h:outputText value="#{recurso.productos.unidadMedida}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center">
                                                                                                <h:outputText value="#{recurso.capitulosTipos.numero}" />
                                                                                                <br/>
                                                                                                <h:outputText value="#{recurso.capitulosTipos.nombre}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPEnero}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPFebero}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPMarzo}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPAbril}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPMayo}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPJunio}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPJulio}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPAgosto}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPSeptiembre}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPOctubre}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPNoviembre}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.RPDiciembre}" />
                                                                                            </p:column>
                                                                                            <p:column style="text-align: center"> 
                                                                                                <h:outputText value="#{recurso.recursosActividad.total}" /> 
                                                                                            </p:column>
                                                                                        </p:dataTable>
                                                                                    </p:panelGrid>
                                                                                </p:rowExpansion>
                                                                            </p:dataTable>
                                                                        </p:column>              
                                                                    </p:dataTable>
                                                                </p:column>              
                                                            </p:dataTable>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p:panel>
            </h:form>
        </c:if>
    </ui:define>
</ui:composition>
