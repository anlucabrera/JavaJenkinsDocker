<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                template="#{layoutMB.template}"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:o="http://omnifaces.org/ui">

    <ui:define name="head-end">
        <h:outputStylesheet library="css" name="tablaDatos.css"/>
        <!-- Inicio estilos par proceso electoral -->
        <c:if test="#{utilidadesAcceso.procesoElectoralActivo}">
            <link rel="stylesheet" type="text/css" href="../resources/css/procesoElectoral.css" media="screen"/>
        </c:if>
        <!-- Fin estilos par proceso electoral -->
    </ui:define>

    <ui:define name="title">
        Cambio de contraseña
    </ui:define>
    <ui:define name="description">
        Cambiar tu contraseña
    </ui:define>

    <ui:define name="head-end">
        <h:outputStylesheet library="css" name="tablaDatos.css"/>
        <h:outputScript library="js" name="dialogs.js"/>
    </ui:define>

    <ui:define name="body">
        <adm:breadcrumb title="Cambio de contraseña"/>
        <div class="contenedor">
            <c:if test="#{cambioPwdEstudiante.tieneAcceso}">
                <h:form id="frm1" prependId="false" class="form-inline">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <div id="main-buttons" class="hidden-sm hidden-xs">
                                <p:toolbar id="tb">
                                    <f:facet name="right">
                                        <p:commandLink
                                                class="btn btn-info"
                                                rendered="#{true}"
                                                disabled="#{false}"
                                                onclick="PF('modalAyuda').show();"
                                                title="Presione el botón para obtener ayuda sobre la operación de ésta herramienta."><i
                                                class="fa fa-question"/>
                                        </p:commandLink>
                                    </f:facet>
                                </p:toolbar>

                            </div>
                        </div>
                    </div>
                </h:form>
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">Ingrese los datos</h3>
                    </div>
                    <div class="box-group">
                        <div class="box login-box-body">
                            <h:form id="frm">
                                <div class="row">
                                    <div class="col-xs-4">
                                        <div class="form-group has-feedback">
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="fa fa-key"></i></span>
                                                <p:password  class="form-control" placeholder="Contraseña actual" value="#{cambioPwdEstudiante.rol.pwdActual}" maxlength="10" required="true" requiredMessage="Debe ingresar la contraseña actual"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-4">
                                        <div class="form-group has-feedback">
                                            <div class="input-group">
                                                <span class="input-group-addon"><i class="fa fa-key"></i></span>
                                                <p:password class="form-control" placeholder="Nueva contraseña" value="#{cambioPwdEstudiante.rol.pwdNueva}" maxlength="10" required="true" requiredMessage="Debe ingresar la nueva contraseña"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-4">
                                        <div class="form-group has-feedback">
                                            <p:commandButton id="btnCambiaPwd" value="Cambiar contraseña" icon="fa fa-key"
                                                             class="btn-primary btn-block col-md-3" update="@form" process="@form" actionListener="#{cambioPwdEstudiante.comprobarPwd()}"
                                                             oncomplete="PF('modalAviso').show();"
                                            />

                                        </div>
                                    </div>
                                </div>

                            </h:form>

                        </div>

                    </div>
                </div>
            </c:if>
            <c:if test="#{cambioPwdEstudiante.tieneAcceso}">

                <!-- Zona de cuadros de diálogo -->
                <p:dialog id="modalAyuda"
                          widgetVar="modalAyuda" width="700" height="auto" closeOnEscape="true" visible="#{false}" showEffect="fade" hideEffect="fade"
                          modal="true" draggable="true" header="Ayuda" styleClass="panel panel-primary" responsive="true" resizable="false" closable="false" maximizable="true">
                    <div class="box box-primary">
                        <div class="box-header"><i class="ion ion-clipboard"></i><h3 class="box-title">Elementos necesarios para cambiar contraseña</h3></div>
                        <div class="box-body">
                            <ul class="todo-list">
                                <c:forEach items="#{cambioPwdEstudiante.rol.instrucciones}" var="instruccion">
                                    <li><span class="text" style="text-align: justify;"><i class="fa fa-ellipsis-v"></i><i class="fa fa-ellipsis-v"></i> #{instruccion}</span></li>
                                </c:forEach>
                            </ul>
                        </div>
                        <div class="box-footer clearfix no-border"><button type="button" class="btn btn-primary pull-right" onclick="PF('modalAyuda').hide();"><i class="fa fa-times"></i> Cerrar</button></div>
                    </div>
                </p:dialog>
            </c:if>
            <p:dialog id="modalAviso"
                      widgetVar="modalAviso" width="700" height="auto" closeOnEscape="true" visible="#{false}" showEffect="fade" hideEffect="fade"
                      modal="true" draggable="true" header="Aviso"  styleClass="panel panel-primary" responsive="true" resizable="false" closable="false" maximizable="true">
                <div class="box box-primary">
                    <div class="box-header"><i class="ion ion-clipboard"></i><h3 class="box-title" >¡AVISO IMPORTANTE DE CAMBIO DE CONTRASEÑA!</h3></div>
                    <div class="box-body">
                        <ul class="todo-list">
                                <li><span class="text" style="text-align: justify;"><i class="fa fa-exclamation-triangle"></i><i class="fa fa-ellipsis-v"></i> En caso de olvidar la contraseña, favor de acudir al departamento de Servicios Escolares a solicitar el cambio de contraseña.</span></li>

                        </ul>
                    </div>
                    <div class="box-footer clearfix no-border"><button type="button" class="btn btn-primary pull-right" onclick="PF('modalAviso').hide();"><i class="fa fa-times"></i> Cerrar</button></div>
                </div>
            </p:dialog>
            <c:if test="#{!cambioPwdEstudiante.tieneAcceso}">
                <p:panel id="box-colors-panel" header="Acceso no autorizado" styleClass="box-fatal box-solid">
                    <h:panelGrid columns="2" cellpadding="10">
                        <h:outputText value="El acceso solo está autorizado a estudiantes."/>
                    </h:panelGrid>
                    <f:facet name="footer"></f:facet>
                </p:panel>
            </c:if>

        </div>



        <script>
            //collapseSidebar(); activar para colapsar barra lateral
        </script>
    </ui:define>
</ui:composition>
