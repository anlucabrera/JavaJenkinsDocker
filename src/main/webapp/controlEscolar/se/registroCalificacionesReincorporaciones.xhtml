<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                template="#{layoutMB.template}"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:o="http://omnifaces.org/ui">

    <ui:define name="head-end">
        <h:outputStylesheet library="css" name="tablaDatos.css"/>
        <!-- Inicio estilos par proceso electoral -->
        <c:if test="#{utilidadesAcceso.procesoElectoralActivo}">
            <link rel="stylesheet" type="text/css" href="../../resources/css/procesoElectoral.css" media="screen"/>
        </c:if>
        <!-- Fin estilos par proceso electoral -->
        <style type="text/css">
            .custom-search-form{
                margin-top:5px;
            }
        </style>
    </ui:define>

    <ui:define name="title">
        Reincorporaciones
    </ui:define>

    <ui:define name="description">

    </ui:define>

    <ui:define name="head-end">
        <h:outputStylesheet library="css" name="tablaDatos.css"/>
        <h:outputScript library="js" name="dialogs.js"/>
    </ui:define>

    <ui:define name="body">
        <c:if test="#{reincorporacionCalificacionesServiciosEscolares.cargado}">
            <adm:breadcrumb title="Reincorporaciones -- Alineacion de Calificaciones"/>
            <adm:sidebar collapsed="true"/>
            <div class="contenedor">
                <c:if test="#{reincorporacionCalificacionesServiciosEscolares.tieneAcceso}">
                    <!-- zona de importación de enums -->

                    <h:form>
                        <p:panel id="toggleable-solid" header="Desea recuperar una reincorporacion da clic en icono +" toggleable="true" toggleSpeed="500"
                                 closeSpeed="500" widgetVar="panel-solid">
                            <div class="row" oncontextmenu="return false">
                                <div class="col-md-12">
                                    <div class="box box-widget widget-user-2">
                                        <div class="row">
                                            <div class="form-group">
                                                <div class="col-sm-12 col-md-15 col-lg-12">
                                                    <p:outputLabel for="estuR" style="font-size: large" value="Seleccione un estudiante" />
                                                    <p:selectOneMenu id="estuR" value="#{reincorporacionCalificacionesServiciosEscolares.rol.estudiante}"
                                                                     filter="true" filterMatchMode="contains" converter="reincorporacionConverter">
                                                        <f:selectItem itemValue="#{null}" itemLabel="Seleccione uno"/>
                                                        <f:selectItems value="#{reincorporacionCalificacionesServiciosEscolares.rol.estudiantesReincorporaciones}" var="estur" 
                                                                       itemValue="#{estur}"
                                                                       itemLabel="#{estur.matricula}--#{estur.aspirante.idPersona.nombre}--#{estur.aspirante.idPersona.apellidoPaterno}--#{estur.aspirante.idPersona.apellidoMaterno}---#{estur.tipoRegistro} " />                                                                                    

                                                        <p:ajax process="@this" update=":regCal" listener="#{reincorporacionCalificacionesServiciosEscolares.buscarAlineacionCalificaciones}"/>

                                                    </p:selectOneMenu>
                                                    <hr/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </p:panel>
                    </h:form>
                    <hr/>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="nav-tabs-custom">
                                <p:outputPanel id="regCal">
                                    <h:form id="capturaCalificaciones">
                                        <div class="row" ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
                                            <div class="col-md-12">
                                                <div class="box box-widget widget-user-2">
                                                    <div class="row">
                                                        <div class="form-group">
                                                            <div class="col-sm-2 col-md-2 col-lg-2">
                                                                <p:outputLabel for="folioI" style="font-size: large;text-align: right;" value="Matrícula:" />
                                                                <p:inputText id="folioI" class="form-control" value="#{reincorporacionCalificacionesServiciosEscolares.rol.estudiante.matricula}"  placeholder="Ingresa tu folio de ficha de admisión" required="true" requiredMessage="Es necesario que ingrese su el folio de ficha de admisión" readonly="true"/>
                                                                <p:message for="folioI"><p:autoUpdate/></p:message>
                                                            </div>
                                                            <div class="col-sm-2 col-md-2 col-lg-2">
                                                                <p:outputLabel for="nombre" style="font-size: large;text-align: right;" value="Nombre:" />
                                                                <p:inputText id="nombre" class="form-control" value="#{reincorporacionCalificacionesServiciosEscolares.rol.estudiante.aspirante.idPersona.nombre}" readonly="true"/>
                                                            </div>
                                                            <div class="col-sm-2 col-md-2 col-lg-2">
                                                                <p:outputLabel for="ap" style="font-size: large;text-align: right;" value="Apellido Paterno" />
                                                                <p:inputText id="ap" class="form-control" value="#{reincorporacionCalificacionesServiciosEscolares.rol.estudiante.aspirante.idPersona.apellidoPaterno}" readonly="true"/>
                                                            </div>
                                                            <div class="col-sm-2 col-md-2 col-lg-2">
                                                                <p:outputLabel for="am" style="font-size: large;text-align: right;" value="Apellido Materno" />
                                                                <p:inputText id="am" class="form-control" value="#{reincorporacionCalificacionesServiciosEscolares.rol.estudiante.aspirante.idPersona.apellidoMaterno}" readonly="true"/>
                                                                <p:inputText id="rt" class="form-control" value="#{reincorporacionCalificacionesServiciosEscolares.rol.calificacionesR.size()}" readonly="true"/>
                                                            </div>        
                                                            <!--div class="col-sm-4 col-md-4 col-lg-4">
                                                                <p:outputLabel for="pe" style="font-size: large;text-align: right;" value="Programa Educativo" />
                                                                <p:inputTextarea id="pe" class="form-control" value="# {reincorporacionCalificacionesServiciosEscolares.rol.rein.opcionIncripcion eq true?reincorporacionCalificacionesServiciosEscolares.rol.rein.primeraOp:reincorporacionCalificacionesServiciosEscolares.rol.rein.segundaOP}" readonly="true"/>
                                                            </div-->
                                                            <div class="col-sm-12 col-md-12 col-lg-12">
                                                                <p:panelGrid columns="3">                                                                        
                                                                    <c:forEach var="i" begin="0" end="#{reincorporacionCalificacionesServiciosEscolares.rol.calificacionesR.size()-1}">
                                                                        <c:set var="t" value="#{reincorporacionCalificacionesServiciosEscolares.rol.calificacionesR.get(i)}"/>
                                                                        <p:panelGrid columns="2">
                                                                            <f:facet name="header">#{t.grupo.grado}° #{t.grupo.literal}</f:facet>
                                                                            <c:forEach var="h" begin="0" end="#{t.calificacionesReincorporacions.size()-1}">
                                                                                <c:set var="j" value="#{t.calificacionesReincorporacions.get(h)}"/>
                                                                                <p:outputLabel value="#{j.estudioMateria.claveMateria}  #{j.materia.nombre}" />
                                                                                <p:inputNumber id="cal-#{j.academica.carga}-#{t.estudiante.idEstudiante}" 
                                                                                               placeholder="0" decimalPlaces="2" minValue="0" maxValue="10"
                                                                                               valueChangeListener="#{reincorporacionCalificacionesServiciosEscolares.guardaCalificaciones}" value="#{j.calificacionPromedio.valor}"  
                                                                                               disabled="#{!j.editable}">
                                                                                    <p:ajax update="@this" process="@this" listener="#{areaPoaProgramacion.imprimirValores()}"/>
                                                                                </p:inputNumber>                                                                                                                                                                        
                                                                            </c:forEach>
                                                                        </p:panelGrid>
                                                                    </c:forEach>
                                                                </p:panelGrid>                                                                    
                                                            </div>                                                                
                                                        </div>
                                                        <div class="row">
                                                            <div class="form-group">
                                                                <div class="col-sm-4 col-md-4 col-lg-4"/>
                                                                <div class="col-sm-4 col-md-4 col-lg-4">
                                                                    <p:outputPanel>
                                                                        <p:autoUpdate/> 
                                                                        <p:commandButton id="btnGuardaGrupos" value="Validar Reincorporacion" icon="fa fa-floppy-o" class="btn-primary btn-block col-md-3" process="@this" update="@form" 
                                                                                         actionListener="#{reincorporacionCalificacionesServiciosEscolares.guardaCalificacionesValidadas()}" 
                                                                                         />
                                                                    </p:outputPanel>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </h:form>
                                </p:outputPanel>
                            </div>
                        </div>
                    </div>                    
                </c:if>
                <c:if test="#{!reincorporacionCalificacionesServiciosEscolares.tieneAcceso}">
                    <p:panel id="box-colors-panel" header="Acceso no autorizado" styleClass="box-fatal box-solid">
                        <h:panelGrid columns="2" cellpadding="10">
                            <h:outputText value="El acceso solo está autorizado al personal perteneciente a servicios escolares."/>
                        </h:panelGrid>
                        <f:facet name="footer"></f:facet>
                    </p:panel>
                </c:if>
            </div>
            <script>
                //collapseSidebar(); activar para colapsar barra lateral
            </script>
        </c:if> 
    </ui:define>
</ui:composition>
