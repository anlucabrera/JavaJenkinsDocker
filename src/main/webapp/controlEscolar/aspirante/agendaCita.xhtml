<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                template="#{layoutMB.template}"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:o="http://omnifaces.org/ui">
    <ui:define name="head-end">
        <h:outputStylesheet library="css" name="tablaDatos.css"/>
        <!-- Inicio estilos par proceso electoral -->
        <c:if test="#{utilidadesAcceso.procesoElectoralActivo}">
            <link rel="stylesheet" type="text/css" href="../resources/css/procesoElectoral.css" media="screen"/>
        </c:if>
        <!-- Fin estilos par proceso electoral -->
        <style type="text/css">
            .custom-search-form{
                margin-top:5px;
            }
        </style>
        <script src="bootstrap-datepicker.XX.js" charset="UTF-8"></script>


    </ui:define>
    <ui:define name="title">
       Agenda cita
    </ui:define>
    <ui:define name="description">
        Regitra tu cita para entrega de documentación.
    </ui:define>
    <ui:define name="head-end">
        <h:outputScript library="js" name="calendario.js" />
        <h:outputScript library="js" name="dialogs.js"/>
        <h:outputStylesheet library="css" name="tablaDatos.css"/>
    </ui:define>
    <ui:define name="body">
        <c:if test="#{agendaCitaInscripcionAspirante.cargado}">
            <adm:breadcrumb title="Registro de cita"/>
            <adm:sidebar collapsed="true"/>
            <div class="contenedor">
                <c:if test="#{agendaCitaInscripcionAspirante.tieneAcceso}">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <div id="main-buttons" class="hidden-sm hidden-xs">
                                <h:form id="frmAviso">
                                    <p:toolbar id="tb">
                                        <f:facet name="left">
                                            <p:outputLabel value="Tienes del : #{caster.convertirFormatoFecha(agendaCitaInscripcionAspirante.rol.eventoEscolar.inicio)}  al #{caster.convertirFormatoFecha(agendaCitaInscripcionAspirante.rol.eventoEscolar.fin)} para agendar tu cita." />
                                            <p:spacer width="5" />

                                        </f:facet>
                                        <f:facet name="right">
                                            <p:commandLink
                                                    class="btn btn-info"
                                                    disabled="#{false}"
                                                    onclick="PF('modalAyuda').show();"
                                                    title="Presione el botón para obtener ayuda sobre la operación de ésta herramienta."><i
                                                    class="fa fa-question"/>
                                            </p:commandLink>
                                        </f:facet>
                                    </p:toolbar>

                                </h:form>
                            </div>
                        </div>
                        <br/>
                        <div class="box box-solid">

                                <div class="box-body">
                                    <c:set var="panel" value="#{'col-sm-12 col-md-6'}"/>
                                    <c:set var="casilla" value="#{'col-sm-12 col-md-6 col-lg-2'}" />
                                    <c:set var="casilla2" value="#{'col-sm-12 col-md-8 col-lg-6'}" />
                                    <c:set var="casilla3" value="#{'col-sm-12 col-md-3 col-lg-1'}" />
                                    <c:set var="casilla4" value="#{'col-sm-3 col-md-3 col-lg-3'}"/>
                                    <c:set var="casilla5" value="#{'col-sm-4 col-md-4 col-lg-4'}"/>
                                    <c:set var="casilla6" value="#{'col-sm-8 col-md-8 col-lg-8'}"/>
                                    <c:set var="casilla7" value="#{'col-sm-6 col-md-6 col-lg-6'}"/>
                                    <h:form id="frmGeneral">
                                    <div class="row margin-bottom" style="margin-top: 20px;">
                                        <div class="#{casilla}">
                                            <div class="ui-material">
                                                <p:inputText id="ficha" value="#{agendaCitaInscripcionAspirante.rol.folio}" required="true"  requiredMessage="Es necesario ingresar el número de folio"/>
                                                <p:outputLabel value="Número de folio" for="ficha"/>
                                                <p:message for="ficha" />

                                            </div>
                                        </div>
                                        <div class="#{casilla3}">
                                            <p:commandButton id="btnBuscar"  actionListener="#{agendaCitaInscripcionAspirante.getRegistro}" styleClass="btn-info" style="margin-right:20px;" icon="fa fa-search" title="Buscar registro"
                                            update=":tab:frmDatos, :tab:frmCita">
                                            </p:commandButton>
                                        </div>
                                    </div>
                                    </h:form>
                                        <div class="row">
                                            <div class="col-lg-12 col-md-12 text-info text-center">
                                                <p:tabView id="tab">
                                                    <p:tab title="Datos de la cita">
                                                        <f:facet name="title"><i class="fa fa-calendar-check-o"> </i><span> Detalles</span></f:facet>
                                                        <div class="row margin-bottom" style="margin-top: 20px;">
                                                           <h:form id="frmDatos">
                                                               <c:set var="per" value="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.aspirante.idPersona}"/>
                                                               <c:set var="aspirante" value="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.aspirante}"/>
                                                               <c:set var="po" value="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.pePrimeraO}"/>
                                                               <c:set var="so" value="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.peSegundaO}"/>
                                                               <c:set var="da" value="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.datosAcademicos}"/>
                                                               <!-- Datos de la ficha de admisión -->
                                                               <div class="#{panel}">
                                                                   <div class="box box-success">
                                                                       <div class="box-header panel-heading with-border">
                                                                           <div class="pull-left"><i class="fa fa-user-o"></i></div>
                                                                           <h3 class="box-title">Datos de la ficha de admisón</h3>
                                                                           <div class="box-tools pull-right">
                                                                               <button class="btn btn-box-tool" data-widget="collapse">
                                                                                   <i class="fa fa-minus"></i>
                                                                               </button>
                                                                           </div>
                                                                       </div>
                                                                       <div class="box-body">
                                                                           <br/>
                                                                           <div class="row">
                                                                               <div class="#{casilla5}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="nombre" class="form-control" value="#{per.nombre}" readonly="true"/>
                                                                                       <p:outputLabel for="nombre" value="Nombre"/>
                                                                                       <p:message for="nombre"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                               <div class="#{casilla5}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="apP" class="form-control"  value="#{per.apellidoPaterno}" readonly="true"/>
                                                                                       <p:outputLabel for="apP" value="Apellido paterno"/>
                                                                                       <p:message for="apP"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                               <div class="#{casilla5}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="apM" class="form-control"  value="#{per.apellidoMaterno}" readonly="true"/>
                                                                                       <p:outputLabel for="apM" value="Apellido materno"/>
                                                                                       <p:message for="apM"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                           </div>
                                                                           <br/><br/>
                                                                           <div class="row">
                                                                               <div class="#{casilla}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="folioA" class="form-control"  value="#{aspirante.folioAspirante}" readonly="true"/>
                                                                                       <p:outputLabel for="folioA" value="Folio"/>
                                                                                       <p:message for="folioA"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                               <div class="#{casilla4}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="fechaR" class="form-control"  value="#{caster.convertirFormatoFecha(aspirante.fechaRegistro)}" readonly="true"/>
                                                                                       <p:outputLabel for="fechaR" value="Fecha de registro"/>
                                                                                       <p:message for="fechaR"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                               <div class="#{casilla4}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="curp" class="form-control"  value="#{per.curp}" readonly="true"/>
                                                                                       <p:outputLabel for="curp" value="CURP"/>
                                                                                       <p:message for="curp"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>

                                                                           </div>
                                                                           <br/><br/>
                                                                           <div class="row">
                                                                               <div class="#{casilla6}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="pePo" class="form-control"  value="#{po.nombre}" readonly="true"/>
                                                                                       <p:outputLabel for="pePo" value="Primera opción"/>
                                                                                       <p:message for="pePo"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                               <div class="#{casilla5}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="sis1" class="form-control"  value="#{da.sistemaPrimeraOpcion.nombre}" readonly="true"/>
                                                                                       <p:outputLabel for="sis1" value="Sistema"/>
                                                                                       <p:message for="sis1"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                           </div>
                                                                           <br/><br/>
                                                                           <div class="row">
                                                                               <div class="#{casilla6}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="peSo" class="form-control"  value="#{so.nombre}" readonly="true"/>
                                                                                       <p:outputLabel for="peSo" value="Segunda opción"/>
                                                                                       <p:message for="peSo"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                               <div class="#{casilla5}">
                                                                                   <div class="ui-material">
                                                                                       <p:inputText id="sis2" class="form-control"  value="#{da.sistemaSegundaOpcion.nombre}" readonly="true"/>
                                                                                       <p:outputLabel for="sis2" value="Sistema"/>
                                                                                       <p:message for="sis2"><p:autoUpdate/></p:message>
                                                                                   </div>
                                                                               </div>
                                                                           </div>
                                                                       </div>
                                                                   </div>
                                                               </div>
                                                           </h:form>
                                                            <h:form id="frmCita">
                                                                <c:set var="cita" value="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.citasAspirantes}"/>
                                                                <!--  Citas registradas-->
                                                                <div class="#{panel}">
                                                                    <div class="box box-warning">
                                                                        <div class="box-header panel-heading with-border">
                                                                            <div class="pull-left"><i class="fa fa-calendar-check-o"></i></div>
                                                                            <h3 class="box-title">Citas programadas</h3>
                                                                            <div class="box-tools pull-right">
                                                                                <button class="btn btn-box-tool" data-widget="collapse">
                                                                                    <i class="fa fa-minus"></i>
                                                                                </button>
                                                                            </div>
                                                                        </div>
                                                                        <div class="box-body">
                                                                            <br/>
                                                                            <div class="row">
                                                                                <div class="#{casilla6}">
                                                                                    <div class="ui-material">
                                                                                      <p:datePicker id="fechaCita" locale="es" value="#{cita.fechaCita}" mindate="#{agendaCitaInscripcionAspirante.rol.tramitesEscolar.fechaInicio}" maxdate="#{agendaCitaInscripcionAspirante.rol.tramitesEscolar.fechaFin}"  showIcon="true"
                                                                                                     disabledDays="#{agendaCitaInscripcionAspirante.rol.invalidDays}"
                                                                                                     disabledDates="#{agendaCitaInscripcionAspirante.rol.invalidDates}"
                                                                                                     required="true" requiredMessage="Es necesario seleccionar la fecha"
                                                                                                     disabled="#{agendaCitaInscripcionAspirante.rol.dis}"
                                                                                                     placeholder="Seleccione la fecha"

                                                                                        >
                                                                                        </p:datePicker>
                                                                                        <p:outputLabel for="fechaCita" value="Seleccione la fecha*"/>
                                                                                        <p:message for="fechaCita"><p:autoUpdate/></p:message>
                                                                                    </div>
                                                                                </div>
                                                                                <c:if test="#{cita.status.equals('Confirmada')}">
                                                                                    <div class="#{casilla}">
                                                                                        <div class="#{casilla3}">
                                                                                            <p:commandButton id="btnRea"  actionListener="#{agendaCitaInscripcionAspirante.changeFecha}" styleClass="btn-warning" style="margin-right:20px;" icon="fa fa-calendar" title="Reagendar cita"
                                                                                                             update=":tab:frmCita" >
                                                                                                <p:confirm header="Cambiar fecha" message="¿Está seguro de cambiar la fecha ?" icon="ui-icon-alert"/>
                                                                                            </p:commandButton>
                                                                                            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                                                                                                <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
                                                                                                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="pi pi-times" />
                                                                                            </p:confirmDialog>

                                                                                        </div>
                                                                                    </div>

                                                                                </c:if>

                                                                            </div>
                                                                            <br/><br/>
                                                                            <div class="row">
                                                                                <div class="#{casilla4}">
                                                                                    <div class="ui-material">
                                                                                        <p:inputText id="folioCita" class="form-control"  value="#{cita.folioCita}" readonly="true"/>
                                                                                        <p:outputLabel for="folioCita" value="Folio de cita"/>
                                                                                        <p:message for="folioCita"><p:autoUpdate/></p:message>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="#{casilla5}">
                                                                                    <div class="ui-material">
                                                                                        <p:inputText id="tramite" class="form-control"  value="#{agendaCitaInscripcionAspirante.rol.tramitesEscolar.tipoTramite}" readonly="true"/>
                                                                                        <p:outputLabel for="tramite" value="Tramite"/>
                                                                                        <p:message for="tramite"><p:autoUpdate/></p:message>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="#{casilla4}">
                                                                                    <div class="ui-material">
                                                                                        <p:inputText id="status" class="form-control"  value="#{cita.status}" readonly="true"/>
                                                                                        <p:outputLabel for="status" value="Estatus"/>
                                                                                        <p:message for="status"><p:autoUpdate/></p:message>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <br/><br/>
                                                                            <c:if test="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.tieneCita.equals(false) || cita.status.equals('Sin confirmar')}">
                                                                                <div class="row">
                                                                                    <div class="#{casilla6}">
                                                                                        <div class="ui-material">
                                                                                            <p:commandButton id="btnConfirmar" value="Confirmar cita" styleClass="btn btn-success" actionListener="#{agendaCitaInscripcionAspirante.saveCita}" update=":tab:frmCita"/>

                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </c:if>
                                                                            <br/><br/>
                                                                            <c:if test="#{agendaCitaInscripcionAspirante.rol.dtoCitaAspirante.tieneCita.equals(true) and cita.status.equals('Confirmada')}">
                                                                                <div class="row">
                                                                                    <div class="#{casilla6}">
                                                                                        <div class="ui-material">
                                                                                            <p:commandButton id="btnComprobante" value="Descargar Comprobante" icon="fa fa-download"
                                                                                                            styleClass="btn btn-info" action="#{agendaCitaInscripcionAspirante.downloadComprobante()}" ajax="false"/>

                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </c:if>

                                                                        </div>
                                                                    </div>
                                                                </div>

                                                            </h:form>
                                                        </div>
                                                    </p:tab>
                                                </p:tabView>

                                            </div>
                                        </div>
                                </div>

                        </div>
                    </div>
                </c:if>
                <!-- Zona de cuadros de diálogo -->
                <p:dialog id="modalAyuda"
                          widgetVar="modalAyuda" width="700" height="auto" closeOnEscape="true" visible="#{false}" showEffect="fade" hideEffect="fade"
                          modal="true" draggable="true" header="Ayuda" styleClass="panel panel-primary" responsive="true" resizable="false" closable="false" maximizable="true">
                    <div class="box box-primary">
                        <div class="box-header"><i class="ion ion-clipboard"></i><h3 class="box-title">Elementos necesarios para agendar cita</h3></div>
                        <div class="box-body">
                            <ul class="todo-list">
                                <c:forEach items="#{agendaCitaInscripcionAspirante.rol.instrucciones}" var="instruccion">
                                    <li><span class="text" style="text-align: justify;"><i class="fa fa-ellipsis-v"></i><i class="fa fa-ellipsis-v"></i> #{instruccion}</span></li>
                                </c:forEach>
                            </ul>
                        </div>
                        <div class="box-footer clearfix no-border"><button type="button" class="btn btn-primary pull-right" onclick="PF('modalAyuda').hide();"><i class="fa fa-times"></i> Cerrar</button></div>
                    </div>
                </p:dialog>
                <c:if test="#{!agendaCitaInscripcionAspirante.tieneAcceso}">
                    <p:panel id="box-colors-panel" header="Acceso no autorizado" styleClass="box-fatal box-solid">
                        <h:panelGrid columns="2" cellpadding="10">
                            <h:outputText value="No contamos con proceso de registro de citas activo."/>
                        </h:panelGrid>
                        <f:facet name="footer"></f:facet>
                    </p:panel>
                </c:if>

            </div>

        </c:if>
    </ui:define>


</ui:composition>