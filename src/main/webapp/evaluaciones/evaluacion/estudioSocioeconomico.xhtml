<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                template="#{layoutMB.template}"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="head-end">
        <style type="text/css">
            .ui-datatable .ui-datatable-header {
                text-align: right !important;
            }
            .description-block{
                text-align: justify;
            }

            .description-header{
                text-align: center;
            }

            .ui-selectonemenu-panel .ui-selectonemenu-filter-container{
                width: 100%;
            }
            .aceptado {
                background-color: #00a7d0  !important;
                text-align: left !important;
            }
            .denegado{
                background-color: #f39c12 !important;
            }
            .ui-progressbar{
                position: relative;
                height: 2em;
            }

            .ui-progressbar .ui-progressbar-label {
                color: #000000;
                text-align: center;
                height: 100%;
                width: 100%;
                position: absolute;
                display: none;
                font-weight: bold;
            }
        </style>
    </ui:define>

    <ui:define name="title">
        Estudio socioeconómico
    </ui:define>

    <ui:define name="description">
        Cuestionario para la recolección de datos socioeconomicos del estudiante
    </ui:define>

    <ui:define name="body">
        <c:if test="#{estudioSocioeconomicoOperativo.cargada}">
        <h:form id="frm" prependId="false" class="form-inline">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div id="main-buttons" class="hidden-sm hidden-xs" >
                        <p:outputPanel>
                            <p:autoUpdate />
                            <p:toolbar id="tb">
                                <f:facet name="left">
                                    <h4>
                                        <span class="label label-primary"><i class="fa fa-info-circle" />
                                            Responder <b>Sí</b> o <b>No</b> según corresponda, algunas preguntas solicitan información adicional.
                                        </span>
                                    </h4>
                                </f:facet>
                                <f:facet name="right">
                                    <c:if test="#{estudioSocioeconomicoOperativo.finalizado}">
                                        <h4><span class="label aceptado"><i class="fa fa-check" />Ha finalizado el cuestionario.</span></h4>
                                    </c:if>
                                    <c:if test="#{!estudioSocioeconomicoOperativo.finalizado}">
                                        <h4><span class="label denegado"><i class="fa fa-close" />Debe responder todas las preguntas.</span></h4>
                                    </c:if>
                                </f:facet>
                            </p:toolbar>
                            <p:sticky target="tb" />
                        </p:outputPanel>
                    </div>
                    <div class="box box-solid">
                        <div class="box-header">
                            <div class="well well-md">
                                <p style="text-align: justify; font-size: larger;">
                                    #{estudioSocioeconomicoOperativo.mensaje}
                                </p>
                            </div>
                        </div>
                        <div class="box-body">
                            <div class="row">
                                <div class="panel panel-primary" style="max-width: 900px;margin: auto; font-size: large;">
                                    <div class="panel-heading aceptado">
                                        <h3 class="panel-title" style="text-align: justify;">
                                            Estudio socioeconómico para el Proyecto de Nación 2018-2024 del Gobierno de México
                                        </h3>
                                    </div>
                                    <table class="table table-striped table-responsive">
                                        <thead>
                                        <tr class="denegado">
                                            <th>#</th>
                                            <th>Pregunta</th>
                                            <th style="text-align: center; width: 400px;">Opción</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <c:set var="index" value="#{0}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r1TienesHijos}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 1 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r2MadrePadreSoltero}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 2 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r3Trabajas}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 3 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <c:if test="#{estudioSocioeconomicoOperativo.mostrar('p'.concat(index))}">
                                            <tr>
                                                <td>#{pregunta.numero}</td>
                                                <td style="text-align: justify;">#{pregunta.titulo}</td>
                                                <td class="danger text-center" style="min-width: 120px;">
                                                    <f:ajax execute="p#{index}">
                                                        <p:inputNumber id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r3aTrabajasIngresoMensual}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}" />
                                                    </f:ajax>
                                                </td>
                                            </tr><!-- 3.1 -->
                                        </c:if>
                                        <c:set var="index" value="#{index+1}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r4PadresEnfermedadTerminal}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 4 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <c:if test="#{estudioSocioeconomicoOperativo.mostrar('p'.concat(index))}">
                                            <tr>
                                                <td>#{pregunta.numero}</td>
                                                <td style="text-align: justify;">#{pregunta.titulo}</td>
                                                <td class="danger text-center" style="min-width: 120px;">
                                                    <f:ajax execute="p#{index}">
                                                        <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r4aPadresEnfermedadTerminalCual}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                            <f:selectItems value="#{estudioSocioeconomicoOperativo.enfermedadesTerminales}" var="enfermedad" itemValue="#{enfermedad}" itemLabel="#{enfermedad.label}" />
                                                        </p:selectOneButton>
                                                    </f:ajax>
                                                </td>
                                            </tr><!-- 4.1 -->
                                        </c:if>
                                        <c:set var="index" value="#{index+1}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <c:if test="#{estudioSocioeconomicoOperativo.mostrar('p'.concat(index))}">
                                            <tr>
                                                <td>#{pregunta.numero}</td>
                                                <td style="text-align: justify;">#{pregunta.titulo}</td>
                                                <td class="danger text-center" style="min-width: 120px;">
                                                    <f:ajax execute="p#{index}">
                                                        <p:inputText  id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r4bPadresEnfermedadTerminalOtra}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}" maxlength="500" styleClass="form-control" style="width: 100%;"/>
                                                    </f:ajax>

                                                </td>
                                            </tr><!-- 4.2 -->
                                        </c:if>
                                        <c:set var="index" value="#{index+1}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r5ProblemaAdverso}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 5 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <c:if test="#{estudioSocioeconomicoOperativo.mostrar('p'.concat(index))}">
                                            <tr>
                                                <td>#{pregunta.numero}</td>
                                                <td style="text-align: justify;">#{pregunta.titulo}</td>
                                                <td class="danger text-center" style="min-width: 120px;">
                                                    <f:ajax execute="p#{index}">
                                                        <p:inputText  id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r5aProblemaAdversoTipo}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}" maxlength="500" styleClass="form-control" style="width: 100%;"/>
                                                    </f:ajax>

                                                </td>
                                            </tr><!-- 5.1 -->
                                        </c:if>
                                        <c:set var="index" value="#{index+1}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r6PobrezaExtrema}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 6 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r7Desnutricion}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 7 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r8DeficienciaFisicaMental}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 8 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <c:if test="#{estudioSocioeconomicoOperativo.mostrar('p'.concat(index))}">
                                            <tr>
                                                <td>#{pregunta.numero}</td>
                                                <td style="text-align: justify;">#{pregunta.titulo}</td>
                                                <td class="danger text-center" style="min-width: 120px;">
                                                    <f:ajax execute="p#{index}">
                                                        <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r8aDeficienciaFisicaMentalCual}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                            <f:selectItems value="#{estudioSocioeconomicoOperativo.deficiencias}" var="deficiencia" itemValue="#{deficiencia}" itemLabel="#{deficiencia.label}" />
                                                        </p:selectOneButton>
                                                    </f:ajax>
                                                </td>
                                            </tr><!-- 8.1 -->
                                        </c:if>
                                        <c:set var="index" value="#{index+1}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <c:if test="#{estudioSocioeconomicoOperativo.mostrar('p'.concat(index))}">
                                            <tr>
                                                <td>#{pregunta.numero}</td>
                                                <td style="text-align: justify;">#{pregunta.titulo}</td>
                                                <td class="danger text-center" style="min-width: 120px;">
                                                    <f:ajax execute="p#{index}">
                                                        <p:inputText  id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r8bDeficienciaFisicaMentalOtra}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}" styleClass="form-control" style="width: 100%;"/>
                                                    </f:ajax>
                                                </td>
                                            </tr><!-- 8.2 -->
                                        </c:if>
                                        <c:set var="index" value="#{index+1}" />
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r9DependenciaEconomicaPadres}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.siNo}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 9 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:inputNumber id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r10IngresoMensualPadres}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}" />
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 10 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r11EscolaridadMaximaPadre}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.escolaridades}" var="escolaridad" itemValue="#{escolaridad}" itemLabel="#{escolaridad.label}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 11 -->
                                        <c:set var="pregunta" value="#{estudioSocioeconomicoOperativo.apartados[0].preguntas[index]}" />
                                        <tr>
                                            <td>#{pregunta.numero}</td>
                                            <td style="text-align: justify;">#{pregunta.titulo}</td>
                                            <td class="danger text-center" style="min-width: 120px;">
                                                <f:ajax execute="p#{index}">
                                                    <p:selectOneButton id="p#{index}" value="#{estudioSocioeconomicoOperativo.resultado.r12EscolaridadMaximaMadre}" valueChangeListener="#{estudioSocioeconomicoOperativo.guardar}">
                                                        <f:selectItems value="#{estudioSocioeconomicoOperativo.escolaridades}" var="escolaridad" itemValue="#{escolaridad}" itemLabel="#{escolaridad.label}" />
                                                    </p:selectOneButton>
                                                </f:ajax>
                                                <c:set var="index" value="#{index+1}" />
                                            </td>
                                        </tr><!-- 12 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </h:form>
            </c:if>
    </ui:define>
</ui:composition>
